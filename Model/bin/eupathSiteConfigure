#!/usr/bin/perl

use strict;

my ($lit1,$project,$lit2,$metaConfigFile) = @ARGV;
my $configTemplateFiles='';

if($project == "OrthoMCL") {
		$configTemplateFiles = 
				"'$ENV{GUS_HOME}/config/model-config.xml.tmpl\\t$ENV{GUS_HOME}/config/\${project}/model-config.xml\\n$ENV{GUS_HOME}/config/model.prop.tmpl\\t$ENV{GUS_HOME}/config/\${project}/model.prop\\n$ENV{GUS_HOME}/config/blast-config.xml.tmpl\\t$ENV{GUS_HOME}/config/blast-config.xml\\n$ENV{GUS_HOME}/config/projects.xml.tmpl\\t$ENV{GUS_HOME}/config/projects.xml'";
} else {
		$configTemplateFiles = 
				"'$ENV{GUS_HOME}/config/model-config.xml.tmpl\\t$ENV{GUS_HOME}/config/\${project}/model-config.xml\\n$ENV{GUS_HOME}/config/model.prop.tmpl\\t$ENV{GUS_HOME}/config/\${project}/model.prop\\n$ENV{GUS_HOME}/config/comment-config.xml.tmpl\\t$ENV{GUS_HOME}/config/\${project}/comment-config.xml\\n$ENV{GUS_HOME}/config/blast-config.xml.tmpl\\t$ENV{GUS_HOME}/config/blast-config.xml\\n$ENV{GUS_HOME}/config/motifSearch-config.xml.tmpl\\t$ENV{GUS_HOME}/config/motifSearch-config.xml\\n$ENV{GUS_HOME}/config/projects.xml.tmpl\\t$ENV{GUS_HOME}/config/projects.xml'";
}

usage($configTemplateFiles) unless scalar(@ARGV) == 4;

my $cmd = "echo -e $configTemplateFiles | generateFilesFromTemplates $ENV{GUS_HOME}/lib/yaml/masterConfig.yaml $metaConfigFile";

print STDERR "\n$cmd\n\n";
system($cmd);

sub usage {
  my ($configTemplateFiles) = @_;
  die "

Configure a EuPathDB website (also OrthoMCL) by reading the provided meta config file, and subsituting values from there into three config templates:
$configTemplateFiles.

Usage: eupathSiteConfigure -model PlasmoDB -filename meta_config_file

Where:
  -model is the website(project name, model name) you want to generate config files for (eg.:PlasmoDB)
  -filename is the meta file where you include the specific information for this website (database, logins etc). 
   See \$PROJECT_HOME/EuPathSiteCommon/Model/lib/yaml/metaConfig.yaml.sample for an example.

To fully understand this command, get the usage for the generateFilesFromTemplates command.

";
}
